{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Output } from '@angular/core';\nimport { ReactiveFormsModule, Validators } from \"@angular/forms\";\nimport { MatFormField, MatFormFieldModule, MatHint, MatLabel } from \"@angular/material/form-field\";\nimport { MatInput } from \"@angular/material/input\";\nimport { MatDatepicker, MatDatepickerInput, MatDatepickerToggle, MatStartDate } from \"@angular/material/datepicker\";\nimport { MatNativeDateModule } from \"@angular/material/core\";\nimport { provideMomentDateAdapter } from \"@angular/material-moment-adapter\";\nimport * as moment from 'moment';\nimport { MatButton } from \"@angular/material/button\";\nexport const MY_FORMATS = {\n  parse: {\n    dateInput: 'yyyy-MM-dd'\n  },\n  display: {\n    dateInput: 'yyyy-MM-DD',\n    monthYearLabel: 'MMM YYYY',\n    dateA11yLabel: 'LL',\n    monthYearA11yLabel: 'MMMM YYYY'\n  }\n};\nlet BrowserFormComponent = class BrowserFormComponent {\n  constructor(fb, fs, fd) {\n    this.fb = fb;\n    this.fs = fs;\n    this.fd = fd;\n    this.flightsSender = new EventEmitter();\n    this.locationsSender = new EventEmitter();\n    this.submitStatus = new EventEmitter();\n    this.locations = [];\n    this.minDate = new Date();\n    this.minReturnDate = new Date();\n    this.flightForm = this.fb.group({\n      origin: ['', Validators.required],\n      destination: ['', Validators.required],\n      adults: ['', [Validators.required, Validators.min(1), Validators.max(10)]],\n      dateOfDeparture: ['', Validators.required],\n      dateOfReturn: ''\n    });\n  }\n  onSubmit() {\n    const originValue = this.flightForm.get('origin').value;\n    const destination = this.flightForm.get('destination').value;\n    this.setFormattedData('dateOfDeparture');\n    this.setFormattedData('dateOfReturn');\n    this.submitStatus.emit(true);\n    console.log(this.flightForm.value);\n    if (originValue && destination) {\n      this.locations[0] = originValue;\n      this.locations[1] = destination;\n      this.locationsSender.emit(this.locations);\n      this.fs.searchCodeForCity(originValue).subscribe(res => {\n        this.flightForm.get('origin')?.setValue(res.data[0].address.cityCode);\n        console.log(this.flightForm.get('origin')?.value);\n        this.fs.searchCodeForCity(destination).subscribe(res => {\n          this.flightForm.get('destination')?.setValue(res.data[0].address.cityCode);\n          console.log(this.flightForm.get('destination')?.value);\n          this.fs.showAvailableFlights(this.flightForm).subscribe(res => {\n            this.availableFlights = res.data;\n            console.log(res);\n            console.log(this.availableFlights);\n            this.flightsSender.emit(this.availableFlights);\n            this.flightForm.reset({}, {\n              emitEvent: false\n            });\n            this.flightForm.clearValidators();\n          });\n        });\n      });\n    }\n  }\n  onSetDepartureDate() {\n    const minDate = new Date(moment(this.flightForm.get('dateOfDeparture').value).format('YYYY-MM-DD'));\n    this.minReturnDate = new Date(minDate.setDate(minDate.getDate()));\n  }\n  setFormattedData(selector) {\n    const date = moment(this.flightForm.get(selector).value);\n    const formattedDate = date.format('YYYY-MM-DD');\n    return this.flightForm.get(selector)?.setValue(formattedDate);\n  }\n};\n__decorate([Output()], BrowserFormComponent.prototype, \"flightsSender\", void 0);\n__decorate([Output()], BrowserFormComponent.prototype, \"locationsSender\", void 0);\n__decorate([Output()], BrowserFormComponent.prototype, \"submitStatus\", void 0);\nBrowserFormComponent = __decorate([Component({\n  selector: 'app-browser-form',\n  standalone: true,\n  imports: [ReactiveFormsModule, MatLabel, MatFormField, MatInput, MatDatepicker, MatFormFieldModule, MatDatepickerInput, MatNativeDateModule, MatHint, MatDatepickerToggle, MatStartDate, MatButton],\n  providers: [provideMomentDateAdapter(MY_FORMATS)],\n  templateUrl: './browser-form.component.html',\n  styleUrls: ['./browser-form.component.scss']\n})], BrowserFormComponent);\nexport { BrowserFormComponent };","map":{"version":3,"names":["Component","EventEmitter","Output","ReactiveFormsModule","Validators","MatFormField","MatFormFieldModule","MatHint","MatLabel","MatInput","MatDatepicker","MatDatepickerInput","MatDatepickerToggle","MatStartDate","MatNativeDateModule","provideMomentDateAdapter","moment","MatButton","MY_FORMATS","parse","dateInput","display","monthYearLabel","dateA11yLabel","monthYearA11yLabel","BrowserFormComponent","constructor","fb","fs","fd","flightsSender","locationsSender","submitStatus","locations","minDate","Date","minReturnDate","flightForm","group","origin","required","destination","adults","min","max","dateOfDeparture","dateOfReturn","onSubmit","originValue","get","value","setFormattedData","emit","console","log","searchCodeForCity","subscribe","res","setValue","data","address","cityCode","showAvailableFlights","availableFlights","reset","emitEvent","clearValidators","onSetDepartureDate","format","setDate","getDate","selector","date","formattedDate","__decorate","standalone","imports","providers","templateUrl","styleUrls"],"sources":["D:\\Projekty\\lot-flight-browser\\frontend\\src\\app\\components\\browser-form\\browser-form.component.ts"],"sourcesContent":["import {Component, EventEmitter, Output} from '@angular/core';\nimport {FormBuilder, FormGroup, ReactiveFormsModule, Validators} from \"@angular/forms\";\nimport {FlightService} from \"../../services/flight/flight.service\";\nimport {MatFormField, MatFormFieldModule, MatHint, MatLabel} from \"@angular/material/form-field\";\nimport {MatInput} from \"@angular/material/input\";\nimport {MatDatepicker, MatDatepickerInput, MatDatepickerToggle, MatStartDate} from \"@angular/material/datepicker\";\nimport {MatNativeDateModule} from \"@angular/material/core\";\nimport {provideMomentDateAdapter} from \"@angular/material-moment-adapter\";\nimport * as moment from 'moment';\nimport {MatButton} from \"@angular/material/button\";\nexport const MY_FORMATS = {\n  parse: {\n    dateInput: 'yyyy-MM-dd',\n  },\n  display: {\n    dateInput: 'yyyy-MM-DD',\n    monthYearLabel: 'MMM YYYY',\n    dateA11yLabel: 'LL',\n    monthYearA11yLabel: 'MMMM YYYY',\n  },\n};\n@Component({\n  selector: 'app-browser-form',\n  standalone: true,\n  imports: [\n    ReactiveFormsModule,\n    MatLabel,\n    MatFormField,\n    MatInput,\n    MatDatepicker,\n    MatFormFieldModule,\n    MatDatepickerInput,\n    MatNativeDateModule,\n    MatHint,\n    MatDatepickerToggle,\n    MatStartDate,\n    MatButton\n  ],\n  providers:[\n    provideMomentDateAdapter(MY_FORMATS)\n  ],\n  templateUrl: './browser-form.component.html',\n  styleUrls: ['./browser-form.component.scss']\n})\nexport class BrowserFormComponent {\n  @Output() flightsSender: EventEmitter<Array<any>> = new EventEmitter();\n  @Output() locationsSender: EventEmitter<string[]> = new EventEmitter();\n  @Output() submitStatus: EventEmitter<boolean> = new EventEmitter();\n  availableFlights!:Array<any>;\n  locations:string[] = [];\n  flightForm!: FormGroup;\n  minDate = new Date();\n  minReturnDate = new Date();\n  constructor(private fb: FormBuilder,\n              private fs: FlightService,\n              private fd) {\n    this.flightForm = this.fb.group({\n      origin: ['', Validators.required],\n      destination: ['', Validators.required],\n      adults: ['', [Validators.required,Validators.min(1),Validators.max(10)]],\n      dateOfDeparture: ['', Validators.required],\n      dateOfReturn: '',\n    });\n  }\n\n  onSubmit(){\n    const originValue = this.flightForm.get('origin')!.value;\n    const destination = this.flightForm.get('destination')!.value;\n    this.setFormattedData('dateOfDeparture');\n    this.setFormattedData('dateOfReturn');\n    this.submitStatus.emit(true);\n    console.log(this.flightForm.value);\n   if (originValue && destination){\n     this.locations[0] = originValue;\n     this.locations[1] = destination;\n     this.locationsSender.emit(this.locations);\n     this.fs.searchCodeForCity(originValue).subscribe((res: any)=>{\n       this.flightForm.get('origin')?.setValue(res.data[0].address.cityCode)\n       console.log(this.flightForm.get('origin')?.value);\n\n       this.fs.searchCodeForCity(destination).subscribe((res: any)=>{\n         this.flightForm.get('destination')?.setValue(res.data[0].address.cityCode)\n         console.log(this.flightForm.get('destination')?.value);\n\n         this.fs.showAvailableFlights(this.flightForm).subscribe((res: any)=>{\n           this.availableFlights = res.data;\n           console.log(res)\n           console.log(this.availableFlights);\n           this.flightsSender.emit(this.availableFlights);\n           this.flightForm.reset({},{emitEvent: false});\n           this.flightForm.clearValidators();\n         })\n       });\n     });\n   }\n  }\n\n  onSetDepartureDate() {\n    const minDate = new Date(moment(this.flightForm.get('dateOfDeparture')!.value).format('YYYY-MM-DD'));\n    this.minReturnDate = new Date(minDate.setDate(minDate.getDate()));\n  }\n\n\n  private setFormattedData(selector:string) {\n    const date: moment.Moment = moment(this.flightForm.get(selector)!.value);\n    const formattedDate: string = date.format('YYYY-MM-DD');\n    return this.flightForm.get(selector)?.setValue(formattedDate);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}